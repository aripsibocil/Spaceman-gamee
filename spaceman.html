<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Spaceman Game</title>
<style>
    body {
        margin: 0;
        background: linear-gradient(to bottom, #0a0a1a, #001f3f);
        color: white;
        font-family: Arial, sans-serif;
        overflow: hidden;
        text-align: center;
    }
    #gameCanvas {
        display: block;
        margin: 0 auto;
        background: transparent;
    }
    .hud {
        position: fixed;
        top: 10px;
        width: 100%;
        display: flex;
        justify-content: space-around;
        font-size: 1.2em;
    }
    button {
        position: fixed;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        background: #ff4d4d;
        border: none;
        padding: 15px 30px;
        font-size: 1.5em;
        color: white;
        border-radius: 10px;
        cursor: pointer;
    }
    button:disabled {
        background: gray;
    }
</style>
</head>
<body>

<div class="hud">
    <div>Multiplier: <span id="multiplier">1.00x</span></div>
    <div>Score: <span id="score">0</span></div>
</div>

<canvas id="gameCanvas" width="360" height="600"></canvas>
<button id="ejectBtn" disabled>EJECT!</button>

<script>
const canvas = document.getElementById("gameCanvas");
const ctx = canvas.getContext("2d");

let spacemanY = 500;
let multiplier = 1.00;
let score = 0;
let flying = false;
let crashed = false;
let crashTime = 0;
let ejectPressed = false;

function drawSpaceman(y) {
    ctx.beginPath();
    ctx.arc(180, y, 20, 0, Math.PI * 2);
    ctx.fillStyle = "white";
    ctx.fill();
    ctx.strokeStyle = "black";
    ctx.stroke();
}

function startRound() {
    multiplier = 1.00;
    spacemanY = 500;
    flying = true;
    crashed = false;
    ejectPressed = false;
    crashTime = 2 + Math.random() * 5; // waktu crash random 2-7 detik
    document.getElementById("ejectBtn").disabled = false;
}

function updateGame(dt) {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    if (flying) {
        multiplier += dt * 0.5; 
        spacemanY -= dt * 50; 
        document.getElementById("multiplier").innerText = multiplier.toFixed(2) + "x";
        drawSpaceman(spacemanY);
    }
}

let lastTime = null;
function gameLoop(timestamp) {
    if (!lastTime) lastTime = timestamp;
    let dt = (timestamp - lastTime) / 1000;
    lastTime = timestamp;

    updateGame(dt);

    if (flying) {
        crashTime -= dt;
        if (crashTime <= 0 && !ejectPressed) {
            flying = false;
            crashed = true;
            document.getElementById("ejectBtn").disabled = true;
            alert("ðŸ’¥ Spaceman meledak! Kamu kalah.");
            setTimeout(startRound, 2000);
        }
    }

    requestAnimationFrame(gameLoop);
}

document.getElementById("ejectBtn").addEventListener("click", () => {
    if (flying && !ejectPressed) {
        ejectPressed = true;
        flying = false;
        let gained = Math.floor(multiplier * 10);
        score += gained;
        document.getElementById("score").innerText = score;
        document.getElementById("ejectBtn").disabled = true;
        alert("âœ… Kamu eject di " + multiplier.toFixed(2) + "x dan dapat " + gained + " poin!");
        setTimeout(startRound, 2000);
    }
});

startRound();
requestAnimationFrame(gameLoop);
</script>

</body>
</html>
